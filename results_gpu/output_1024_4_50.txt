2025-08-01 12:29:38.614421: W external/xla/xla/service/platform_util.cc:220] unable to create StreamExecutor for CUDA:2: CUDA error: Failed call to cuDeviceGet: CUDA_ERROR_INVALID_DEVICE: invalid device ordinal
Traceback (most recent call last):
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/xla_bridge.py", line 857, in backends
    backend = _init_backend(platform)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/xla_bridge.py", line 943, in _init_backend
    backend = registration.factory()
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/xla_bridge.py", line 643, in factory
    return xla_client.make_c_api_client(
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jaxlib/xla_client.py", line 159, in make_c_api_client
    return _xla.get_c_api_client(plugin_name, options, distributed_client)
jaxlib.xla_extension.XlaRuntimeError: INTERNAL: no supported devices found for platform CUDA

During handling of the above exception, another exception occurred:

jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/a/a270230/veris_minimum_working_example/run_files/run_parallel_1024_4.py", line 27, in <module>
    from initialize_dyn_1024 import vs, sett
  File "/home/a/a270230/veris_minimum_working_example/run_files/initialize_dyn_1024.py", line 69, in <module>
    zeros2d = jnp.zeros((grid_len+2*olx, grid_len+2*oly), dtype=accuracy)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/numpy/array_creation.py", line 79, in zeros
    return lax.full(shape, 0, dtypes.jax_dtype(dtype), sharding=util.normalize_device_to_sharding(device))
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 3340, in full
    fill_value = _convert_element_type(fill_value, dtype, weak_type)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 1727, in _convert_element_type
    return convert_element_type_p.bind(
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/core.py", line 496, in bind
    return self._true_bind(*args, **params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/core.py", line 512, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 4875, in _convert_element_type_bind_with_trace
    operand = core.Primitive.bind_with_trace(convert_element_type_p, trace, args, params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/core.py", line 517, in bind_with_trace
    return trace.process_primitive(self, args, params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/core.py", line 1017, in process_primitive
    return primitive.impl(*args, **params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/dispatch.py", line 89, in apply_primitive
    outs = fun(*args)
RuntimeError: Unable to initialize backend 'cuda': INTERNAL: no supported devices found for platform CUDA (you may need to uninstall the failing plugin package, or set JAX_PLATFORMS=cpu to skip this backend.)
2025-08-01 12:29:38.718425: W external/xla/xla/service/platform_util.cc:220] unable to create StreamExecutor for CUDA:1: CUDA error: Failed call to cuDeviceGet: CUDA_ERROR_INVALID_DEVICE: invalid device ordinal
Traceback (most recent call last):
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/xla_bridge.py", line 857, in backends
    backend = _init_backend(platform)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/xla_bridge.py", line 943, in _init_backend
    backend = registration.factory()
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/xla_bridge.py", line 643, in factory
    return xla_client.make_c_api_client(
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jaxlib/xla_client.py", line 159, in make_c_api_client
    return _xla.get_c_api_client(plugin_name, options, distributed_client)
jaxlib.xla_extension.XlaRuntimeError: INTERNAL: no supported devices found for platform CUDA

During handling of the above exception, another exception occurred:

jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/a/a270230/veris_minimum_working_example/run_files/run_parallel_1024_4.py", line 27, in <module>
    from initialize_dyn_1024 import vs, sett
  File "/home/a/a270230/veris_minimum_working_example/run_files/initialize_dyn_1024.py", line 69, in <module>
    zeros2d = jnp.zeros((grid_len+2*olx, grid_len+2*oly), dtype=accuracy)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/numpy/array_creation.py", line 79, in zeros
    return lax.full(shape, 0, dtypes.jax_dtype(dtype), sharding=util.normalize_device_to_sharding(device))
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 3340, in full
    fill_value = _convert_element_type(fill_value, dtype, weak_type)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 1727, in _convert_element_type
    return convert_element_type_p.bind(
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/core.py", line 496, in bind
    return self._true_bind(*args, **params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/core.py", line 512, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 4875, in _convert_element_type_bind_with_trace
    operand = core.Primitive.bind_with_trace(convert_element_type_p, trace, args, params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/core.py", line 517, in bind_with_trace
    return trace.process_primitive(self, args, params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/core.py", line 1017, in process_primitive
    return primitive.impl(*args, **params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/dispatch.py", line 89, in apply_primitive
    outs = fun(*args)
RuntimeError: Unable to initialize backend 'cuda': INTERNAL: no supported devices found for platform CUDA (you may need to uninstall the failing plugin package, or set JAX_PLATFORMS=cpu to skip this backend.)
2025-08-01 12:29:38.889916: W external/xla/xla/service/platform_util.cc:220] unable to create StreamExecutor for CUDA:3: CUDA error: Failed call to cuDeviceGet: CUDA_ERROR_INVALID_DEVICE: invalid device ordinal
Traceback (most recent call last):
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/xla_bridge.py", line 857, in backends
    backend = _init_backend(platform)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/xla_bridge.py", line 943, in _init_backend
    backend = registration.factory()
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/xla_bridge.py", line 643, in factory
    return xla_client.make_c_api_client(
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jaxlib/xla_client.py", line 159, in make_c_api_client
    return _xla.get_c_api_client(plugin_name, options, distributed_client)
jaxlib.xla_extension.XlaRuntimeError: INTERNAL: no supported devices found for platform CUDA

During handling of the above exception, another exception occurred:

jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/a/a270230/veris_minimum_working_example/run_files/run_parallel_1024_4.py", line 27, in <module>
    from initialize_dyn_1024 import vs, sett
  File "/home/a/a270230/veris_minimum_working_example/run_files/initialize_dyn_1024.py", line 69, in <module>
    zeros2d = jnp.zeros((grid_len+2*olx, grid_len+2*oly), dtype=accuracy)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/numpy/array_creation.py", line 79, in zeros
    return lax.full(shape, 0, dtypes.jax_dtype(dtype), sharding=util.normalize_device_to_sharding(device))
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 3340, in full
    fill_value = _convert_element_type(fill_value, dtype, weak_type)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 1727, in _convert_element_type
    return convert_element_type_p.bind(
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/core.py", line 496, in bind
    return self._true_bind(*args, **params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/core.py", line 512, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 4875, in _convert_element_type_bind_with_trace
    operand = core.Primitive.bind_with_trace(convert_element_type_p, trace, args, params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/core.py", line 517, in bind_with_trace
    return trace.process_primitive(self, args, params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/core.py", line 1017, in process_primitive
    return primitive.impl(*args, **params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/dispatch.py", line 89, in apply_primitive
    outs = fun(*args)
RuntimeError: Unable to initialize backend 'cuda': INTERNAL: no supported devices found for platform CUDA (you may need to uninstall the failing plugin package, or set JAX_PLATFORMS=cpu to skip this backend.)

********************************************************************************
*                                                                              *
*  This is the automated job summary provided by DKRZ.                         *
*  If you encounter problems, need assistance or have any suggestion, please   *
*  write an email to                                                           *
*                                                                              *
*  --  support@dkrz.de --                                                      *
*                                                                              *
*                       We hope you enjoyed the DKRZ supercomputer LEVANTE ... *
*
* JobID            : 18796005
* JobName          : 1024_4_50                                         
* Account          : bk1377_gpu
* User             : a270230 (275572), ab0995 (1221)                   
* Partition        : gpu
* QOS              : normal
* Nodelist         : l50021 (1)                                                
* Submit date      : 2025-08-01T12:27:46
* Start time       : 2025-08-01T12:27:50
* End time         : 2025-08-01T12:29:17
* Elapsed time     : 00:01:27 (Timelimit=04:00:00)                     
* Command          : /home/a/a270230/veris_minimum_working_example/run_files/
*                    job_1024_4_50.sh
* WorkDir          : /home/a/a270230/veris_minimum_working_example
*
* StepID | JobName      NodeHours    MaxRSS [Byte] (@task)
* ------------------------------------------------------------------------------
* 0      | python3          0.041              231528K (0)
* batch  | batch            0.024
* extern | extern           0.041                2160K (0)
* ------------------------------------------------------------------------------

Traceback (most recent call last):
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/xla_bridge.py", line 857, in backends
    backend = _init_backend(platform)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/xla_bridge.py", line 943, in _init_backend
    backend = registration.factory()
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/xla_bridge.py", line 643, in factory
    return xla_client.make_c_api_client(
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jaxlib/xla_client.py", line 159, in make_c_api_client
    return _xla.get_c_api_client(plugin_name, options, distributed_client)
jaxlib.xla_extension.XlaRuntimeError: INTERNAL: Getting local topologies failed: Error 1: GetKeyValue() timed out with key: cuda:local_topology/cuda/1 and duration: 2m

Error 2: GetKeyValue() timed out with key: cuda:local_topology/cuda/2 and duration: 2m

Error 3: GetKeyValue() timed out with key: cuda:local_topology/cuda/3 and duration: 2m

During handling of the above exception, another exception occurred:

jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/a/a270230/veris_minimum_working_example/run_files/run_parallel_1024_4.py", line 27, in <module>
    from initialize_dyn_1024 import vs, sett
  File "/home/a/a270230/veris_minimum_working_example/run_files/initialize_dyn_1024.py", line 69, in <module>
    zeros2d = jnp.zeros((grid_len+2*olx, grid_len+2*oly), dtype=accuracy)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/numpy/array_creation.py", line 79, in zeros
    return lax.full(shape, 0, dtypes.jax_dtype(dtype), sharding=util.normalize_device_to_sharding(device))
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 3340, in full
    fill_value = _convert_element_type(fill_value, dtype, weak_type)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 1727, in _convert_element_type
    return convert_element_type_p.bind(
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/core.py", line 496, in bind
    return self._true_bind(*args, **params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/core.py", line 512, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 4875, in _convert_element_type_bind_with_trace
    operand = core.Primitive.bind_with_trace(convert_element_type_p, trace, args, params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/core.py", line 517, in bind_with_trace
    return trace.process_primitive(self, args, params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/core.py", line 1017, in process_primitive
    return primitive.impl(*args, **params)
  File "/home/a/a270230/.conda/envs/veros/lib/python3.10/site-packages/jax/_src/dispatch.py", line 89, in apply_primitive
    outs = fun(*args)
RuntimeError: Unable to initialize backend 'cuda': INTERNAL: Getting local topologies failed: Error 1: GetKeyValue() timed out with key: cuda:local_topology/cuda/1 and duration: 2m

Error 2: GetKeyValue() timed out with key: cuda:local_topology/cuda/2 and duration: 2m

Error 3: GetKeyValue() timed out with key: cuda:local_topology/cuda/3 and duration: 2m (you may need to uninstall the failing plugin package, or set JAX_PLATFORMS=cpu to skip this backend.)
srun: error: l50048: task 2: Exited with exit code 1
srun: Terminating StepId=18796024.0
slurmstepd: error: *** STEP 18796024.0 ON l50048 CANCELLED AT 2025-08-01T12:33:39 ***
srun: error: l50048: tasks 1,3: Exited with exit code 1
srun: error: l50048: task 0: Exited with exit code 1

********************************************************************************
*                                                                              *
*  This is the automated job summary provided by DKRZ.                         *
*  If you encounter problems, need assistance or have any suggestion, please   *
*  write an email to                                                           *
*                                                                              *
*  --  support@dkrz.de --                                                      *
*                                                                              *
*                       We hope you enjoyed the DKRZ supercomputer LEVANTE ... *
*
* JobID            : 18796024
* JobName          : 1024_4_50                                         
* Account          : bk1377_gpu
* User             : a270230 (275572), ab0995 (1221)                   
* Partition        : gpu
* QOS              : normal
* Nodelist         : l50048 (1)                                                
* Submit date      : 2025-08-01T12:29:26
* Start time       : 2025-08-01T12:29:32
* End time         : 2025-08-01T12:33:40
* Elapsed time     : 00:04:08 (Timelimit=04:00:00)                     
* Command          : /home/a/a270230/veris_minimum_working_example/run_files/
*                    job_1024_4_50.sh
* WorkDir          : /home/a/a270230/veris_minimum_working_example
*
* StepID | JobName      NodeHours    MaxRSS [Byte] (@task)
* ------------------------------------------------------------------------------
* 0      | python3          0.068              231288K (0)
* batch  | batch            0.069
* extern | extern           0.069                2160K (0)
* ------------------------------------------------------------------------------

